<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enterprise Financial Records</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .table-container { scrollbar-width: thin; }
        /* Custom Zebra Striping for better readability */
        tbody tr:nth-child(even) { background-color: #f9fafb; }
        /* Smooth transition for hover */
        tbody tr { transition: all 0.2s ease; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 antialiased min-h-screen p-4 md:p-8">

    <div class="max-w-7xl mx-auto">
        <div class="mb-8 flex flex-col md:flex-row md:items-center justify-between gap-4">
            <div>
                <h1 class="text-2xl font-bold tracking-tight text-slate-900">Financial Records</h1>
                <p class="text-slate-500 text-sm">Manage and audit global grant distributions and sponsorships.</p>
            </div>
            <div class="flex items-center gap-3">
                <button class="inline-flex items-center gap-2 bg-white border border-slate-200 px-4 py-2 rounded-lg text-sm font-medium hover:bg-slate-50 transition-colors shadow-sm">
                    <i data-lucide="download" class="w-4 h-4"></i> Export CSV
                </button>
                <button class="inline-flex items-center gap-2 bg-indigo-600 px-4 py-2 rounded-lg text-sm font-medium text-white hover:bg-indigo-700 transition-colors shadow-sm shadow-indigo-200">
                    <i data-lucide="plus" class="w-4 h-4"></i> New Entry
                </button>
            </div>
        </div>

        <div class="bg-white p-4 rounded-t-xl border border-slate-200 border-b-0 flex flex-col md:flex-row justify-between items-center gap-4">
            <div class="relative w-full md:w-96">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <i data-lucide="search" class="w-4 h-4 text-slate-400"></i>
                </div>
                <input type="text" id="globalSearch" 
                    class="block w-full pl-10 pr-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm transition-all" 
                    placeholder="Search by grantee, category, or details...">
            </div>
            
            <div class="flex items-center gap-4 w-full md:w-auto">
                <div class="flex items-center gap-2 text-sm text-slate-500">
                    <span>Show</span>
                    <select id="pageSize" class="border border-slate-200 rounded-md py-1 px-2 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        <option value="10">10</option>
                        <option value="25">25</option>
                        <option value="50">50</option>
                    </select>
                    <span>entries</span>
                </div>
            </div>
        </div>

        <div class="bg-white border border-slate-200 rounded-b-xl shadow-sm overflow-hidden">
            <div class="overflow-x-auto table-container">
                <table class="w-full text-sm text-left border-collapse" id="mainTable">
                    <thead>
                        <tr class="bg-slate-50 border-b border-slate-200">
                            <th class="px-6 py-4 font-semibold text-slate-600 cursor-pointer hover:text-indigo-600" data-sort="id">
                                <div class="flex items-center gap-1">No. <i data-lucide="chevrons-up-down" class="w-3 h-3"></i></div>
                            </th>
                            <th class="px-6 py-4 font-semibold text-slate-600 cursor-pointer hover:text-indigo-600" data-sort="grantee">
                                <div class="flex items-center gap-1">Grantee <i data-lucide="chevrons-up-down" class="w-3 h-3"></i></div>
                            </th>
                            <th class="px-6 py-4 font-semibold text-slate-600 hidden lg:table-cell">Geography</th>
                            <th class="px-6 py-4 font-semibold text-slate-600">Category</th>
                            <th class="px-6 py-4 font-semibold text-slate-600 text-right" data-sort="ugx">
                                <div class="flex items-center justify-end gap-1">Amount (UGX) <i data-lucide="chevrons-up-down" class="w-3 h-3"></i></div>
                            </th>
                            <th class="px-6 py-4 font-semibold text-slate-600 text-center">Action</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody" class="divide-y divide-slate-100">
                        </tbody>
                </table>
            </div>

            <div id="emptyState" class="hidden py-20 flex-col items-center justify-center text-center">
                <div class="bg-slate-100 p-4 rounded-full mb-4">
                    <i data-lucide="database-zap" class="w-8 h-8 text-slate-400"></i>
                </div>
                <h3 class="text-lg font-medium text-slate-900">No records found</h3>
                <p class="text-slate-500 max-w-xs mx-auto">Try adjusting your search or filters to find what you're looking for.</p>
                <button onclick="resetFilters()" class="mt-4 text-indigo-600 font-medium hover:underline">Clear all filters</button>
            </div>

            <div class="px-6 py-4 border-t border-slate-200 bg-slate-50 flex flex-col sm:flex-row items-center justify-between gap-4">
                <div class="text-sm text-slate-500">
                    Showing <span id="showingStart" class="font-medium text-slate-900">0</span> to 
                    <span id="showingEnd" class="font-medium text-slate-900">0</span> of 
                    <span id="totalResults" class="font-medium text-slate-900">0</span> entries
                </div>
                <div class="flex items-center gap-2" id="paginationControls">
                    </div>
            </div>
        </div>
    </div>

    <script>
        /**
         * 1. DATA SOURCE
         */
        const DATA = [
            { id: 1598, grantee: "Kampala Archidiocese Youth Apostolate", year: 2025, geography: "Africa / Kampala", details: "Payment made towards Sponsorship support for Kampala Archdiocese youth Apostolate run 2025", category: "Community", ugx: 5000000, usd: 0, link: "#" },
            { id: 1597, grantee: "Nnaabagereka Nagginda Women's fund", year: 2025, geography: "Africa / Kampala", details: "Support for mental health, psychosocial support, education initiatives", category: "Sponsorship", ugx: 25000000, usd: 0, link: "#" },
            { id: 1596, grantee: "SHREE KACHCHHI LEVA PATEL SAMAJ", year: 2025, geography: "Africa / Kampala", details: "Sponsor in Shree kutchi Leva patel Samaj for Navrati Festival 2023", category: "Community", ugx: 10000000, usd: 0, link: "#" },
            { id: 1595, grantee: "Katwe Cycling Club", year: 2025, geography: "Africa / Kampala", details: "Sponsorship to the independence day cycling solidarity Race 2025", category: "Sponsorship", ugx: 5000000, usd: 0, link: "#" },
            { id: 1594, grantee: "Uganda Council On Foreign Relations", year: 2025, geography: "Africa / Kampala", details: "Advancing migration governance for workers' empowerment advocacy", category: "Sponsorship", ugx: 10000000, usd: 0, link: "#" },
            { id: 1581, grantee: "UWESO Vocational Training Project", year: 2025, geography: "Africa / Kampala", details: "Sponsorship for Uganda Women's effort to save orphans", category: "Sponsorship", ugx: 25000000, usd: 0, link: "#" },
            { id: 1580, grantee: "Henry Samson Otete", year: 2025, geography: "Africa / Kampala", details: "Contribution for free vegetarian food program for school pupils", category: "Donation", ugx: 500000, usd: 0, link: "#" }
        ];

        /**
         * 2. COMPONENT STATE
         */
        let state = {
            searchQuery: '',
            sortColumn: 'id',
            sortDirection: 'desc',
            currentPage: 1,
            pageSize: 10,
            isLoading: true
        };

        /**
         * 3. UI RENDER ENGINE
         */
        function render() {
            const tableBody = document.getElementById('tableBody');
            const emptyState = document.getElementById('emptyState');
            const tableElement = document.getElementById('mainTable');

            // 3a. Filter Data
            let filteredData = DATA.filter(item => {
                const searchStr = `${item.grantee} ${item.category} ${item.id} ${item.details}`.toLowerCase();
                return searchStr.includes(state.searchQuery.toLowerCase());
            });

            // 3b. Sort Data
            filteredData.sort((a, b) => {
                let valA = a[state.sortColumn];
                let valB = b[state.sortColumn];
                if (typeof valA === 'string') {
                    return state.sortDirection === 'asc' 
                        ? valA.localeCompare(valB) 
                        : valB.localeCompare(valA);
                }
                return state.sortDirection === 'asc' ? valA - valB : valB - valA;
            });

            // 3c. Paginate Data
            const total = filteredData.length;
            const totalPages = Math.ceil(total / state.pageSize);
            state.currentPage = Math.min(state.currentPage, totalPages) || 1;
            const start = (state.currentPage - 1) * state.pageSize;
            const paginatedData = filteredData.slice(start, start + state.pageSize);

            // 3d. Update UI
            tableBody.innerHTML = '';
            
            if (paginatedData.length === 0) {
                tableElement.classList.add('hidden');
                emptyState.classList.remove('hidden');
                emptyState.classList.add('flex');
            } else {
                tableElement.classList.remove('hidden');
                emptyState.classList.add('hidden');
                emptyState.classList.remove('flex');

                paginatedData.forEach(row => {
                    const tr = document.createElement('tr');
                    tr.className = "hover:bg-indigo-50/30 cursor-default";
                    tr.innerHTML = `
                        <td class="px-6 py-4 font-medium text-slate-900">#${row.id}</td>
                        <td class="px-6 py-4">
                            <div class="font-medium text-slate-900">${row.grantee}</div>
                            <div class="text-xs text-slate-400 mt-0.5">${row.year}</div>
                        </td>
                        <td class="px-6 py-4 text-slate-500 hidden lg:table-cell">${row.geography}</td>
                        <td class="px-6 py-4">
                            <span class="${getCategoryStyle(row.category)} px-2.5 py-0.5 rounded-full text-xs font-medium">
                                ${row.category}
                            </span>
                        </td>
                        <td class="px-6 py-4 text-right font-mono font-semibold text-slate-700">
                            ${new Intl.NumberFormat('en-UG').format(row.ugx)}
                        </td>
                        <td class="px-6 py-4 text-center">
                            <a href="${row.link}" class="text-indigo-600 hover:text-indigo-900 font-medium inline-flex items-center gap-1">
                                View <i data-lucide="external-link" class="w-3 h-3"></i>
                            </a>
                        </td>
                    `;
                    tableBody.appendChild(tr);
                });
            }

            // Update Pagination Info
            document.getElementById('showingStart').innerText = total === 0 ? 0 : start + 1;
            document.getElementById('showingEnd').innerText = Math.min(start + state.pageSize, total);
            document.getElementById('totalResults').innerText = total;

            renderPagination(totalPages);
            lucide.createIcons();
        }

        function renderPagination(totalPages) {
            const container = document.getElementById('paginationControls');
            container.innerHTML = '';

            const btnClass = "px-3 py-1 border border-slate-200 rounded-md text-sm font-medium hover:bg-white transition-all disabled:opacity-30 disabled:cursor-not-allowed";
            
            // Prev
            const prev = document.createElement('button');
            prev.className = btnClass;
            prev.innerHTML = `<i data-lucide="chevron-left" class="w-4 h-4"></i>`;
            prev.disabled = state.currentPage === 1;
            prev.onclick = () => { state.currentPage--; render(); };
            container.appendChild(prev);

            // Page Numbers (Simplified)
            for(let i=1; i <= totalPages; i++) {
                if(i === 1 || i === totalPages || (i >= state.currentPage - 1 && i <= state.currentPage + 1)) {
                    const p = document.createElement('button');
                    p.innerText = i;
                    p.className = `${btnClass} ${state.currentPage === i ? 'bg-indigo-600 text-white border-indigo-600 hover:bg-indigo-700' : 'text-slate-600'}`;
                    p.onclick = () => { state.currentPage = i; render(); };
                    container.appendChild(p);
                } else if (i === state.currentPage - 2 || i === state.currentPage + 2) {
                    const span = document.createElement('span');
                    span.innerText = '...';
                    span.className = "text-slate-400 px-1";
                    container.appendChild(span);
                }
            }

            // Next
            const next = document.createElement('button');
            next.className = btnClass;
            next.innerHTML = `<i data-lucide="chevron-right" class="w-4 h-4"></i>`;
            next.disabled = state.currentPage === totalPages || totalPages === 0;
            next.onclick = () => { state.currentPage++; render(); };
            container.appendChild(next);
        }

        /**
         * 4. UTILITIES
         */
        function getCategoryStyle(cat) {
            switch(cat.toLowerCase()) {
                case 'community': return 'bg-blue-50 text-blue-700 border border-blue-100';
                case 'sponsorship': return 'bg-purple-50 text-purple-700 border border-purple-100';
                case 'donation': return 'bg-emerald-50 text-emerald-700 border border-emerald-100';
                default: return 'bg-slate-50 text-slate-700 border border-slate-100';
            }
        }

        function debounce(func, timeout = 300){
            let timer;
            return (...args) => {
                clearTimeout(timer);
                timer = setTimeout(() => { func.apply(this, args); }, timeout);
            };
        }

        function resetFilters() {
            document.getElementById('globalSearch').value = '';
            state.searchQuery = '';
            render();
        }

        /**
         * 5. EVENT LISTENERS
         */
        document.getElementById('globalSearch').addEventListener('input', debounce((e) => {
            state.searchQuery = e.target.value;
            state.currentPage = 1;
            render();
        }));

        document.getElementById('pageSize').addEventListener('change', (e) => {
            state.pageSize = parseInt(e.target.value);
            state.currentPage = 1;
            render();
        });

        document.querySelectorAll('th[data-sort]').forEach(th => {
            th.addEventListener('click', () => {
                const col = th.dataset.sort;
                if (state.sortColumn === col) {
                    state.sortDirection = state.sortDirection === 'asc' ? 'desc' : 'asc';
                } else {
                    state.sortColumn = col;
                    state.sortDirection = 'asc';
                }
                render();
            });
        });

        // Initial Render
        window.addEventListener('DOMContentLoaded', () => {
            // Simulate loading
            setTimeout(() => {
                render();
            }, 500);
        });
    </script>
</body>
</html>